// üö® SISTEMA EMERGENCIAL VERCEL - FALLBACK TOTAL
console.log('üö® CARREGANDO EMBEDDED REFS EMERGENCIAL - VERCEL FALLBACK');

// ‚ö° DADOS EMBEDDED COMPLETOS PARA RESOLVER 404s
window.__EMERGENCY_VERCEL_REFS__ = true;
window.PROD_AI_REF_DATA = {
  "eletrofunk": {
    "version": "2025-08-recalc-eletrofunk-arithmetic-means",
    "generated_at": "2025-08-25T02:15:41.042Z",
    "num_tracks": 14,
    "aggregation_method": "arithmetic_mean_corrected",
    "legacy_compatibility": {
      "lufs_target": -9.2,
      "tol_lufs": 1.5,
      "tol_lufs_min": 1.5,
      "tol_lufs_max": 1.5,
      "true_peak_target": -2.5,
      "tol_true_peak": 1,
      "dr_target": 6.8,
      "tol_dr": 2,
      "dr_stat_target": 6.8,
      "tol_dr_stat": 2,
      "lra_target": 7.8,
      "tol_lra": 1.6,
      "lra_min": 6.24,
      "lra_max": 9.36,
      "stereo_target": 0.38,
      "tol_stereo": 0.15,
      "bands": {
        "sub": {
          "target_db": -6.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_bass": {
          "target_db": -4.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "upper_bass": {
          "target_db": -7.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_mid": {
          "target_db": -4.1,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "mid": {
          "target_db": -1.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "high_mid": {
          "target_db": -6.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "brilho": {
          "target_db": -9.5,
          "tol_db": 1.9,
          "severity": "soft"
        },
        "presenca": {
          "target_db": -13.2,
          "tol_db": 2.6,
          "severity": "soft"
        }
      }
    },
    "recalculation_info": {
      "method": "arithmetic_mean",
      "calculated_at": "2025-08-25T02:15:41.042Z",
      "source": "recalcular-referencias-completo.js",
      "validation": "17_tracks_processed",
      "note": "M√©dias aritm√©ticas recalculadas corretamente, substituindo valores anteriores incorretos"
    }
  },
  "eletronico": {
    "version": "2025-08-recalc-eletronico-arithmetic-means",
    "generated_at": "2025-08-25T02:15:41.029Z",
    "num_tracks": 20,
    "aggregation_method": "arithmetic_mean_corrected",
    "legacy_compatibility": {
      "lufs_target": -12.8,
      "tol_lufs": 1.9,
      "tol_lufs_min": 1.9,
      "tol_lufs_max": 1.9,
      "true_peak_target": -0.8,
      "tol_true_peak": 1,
      "dr_target": 7.2,
      "tol_dr": 2,
      "dr_stat_target": 7.2,
      "tol_dr_stat": 2,
      "lra_target": 6.5,
      "tol_lra": 1.5,
      "lra_min": 5,
      "lra_max": 8,
      "stereo_target": 0.25,
      "tol_stereo": 0.15,
      "bands": {
        "sub": {
          "target_db": -8.5,
          "tol_db": 1.7,
          "severity": "soft"
        },
        "low_bass": {
          "target_db": -6.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "upper_bass": {
          "target_db": -8.8,
          "tol_db": 1.8,
          "severity": "soft"
        },
        "low_mid": {
          "target_db": -5.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "mid": {
          "target_db": -3.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "high_mid": {
          "target_db": -4.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "brilho": {
          "target_db": -7.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "presenca": {
          "target_db": -11.5,
          "tol_db": 2.3,
          "severity": "soft"
        }
      }
    },
    "recalculation_info": {
      "method": "arithmetic_mean",
      "calculated_at": "2025-08-25T02:15:41.030Z",
      "source": "recalcular-referencias-completo.js",
      "validation": "17_tracks_processed",
      "note": "M√©dias aritm√©ticas recalculadas corretamente, substituindo valores anteriores incorretos"
    }
  },
  "funk_automotivo": {
    "version": "2025-08-recalc-funk_automotivo-arithmetic-means",
    "generated_at": "2025-08-25T02:15:41.007Z",
    "num_tracks": 12,
    "aggregation_method": "arithmetic_mean_corrected",
    "legacy_compatibility": {
      "lufs_target": -6.2,
      "tol_lufs": 1.5,
      "tol_lufs_min": 1.5,
      "tol_lufs_max": 1.5,
      "true_peak_target": -2.8,
      "tol_true_peak": 1,
      "dr_target": 6.8,
      "tol_dr": 2,
      "dr_stat_target": 6.8,
      "tol_dr_stat": 2,
      "lra_target": 8.2,
      "tol_lra": 1.6,
      "lra_min": 6.56,
      "lra_max": 9.84,
      "stereo_target": 0.4,
      "tol_stereo": 0.15,
      "bands": {
        "sub": {
          "target_db": -4.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_bass": {
          "target_db": -3.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "upper_bass": {
          "target_db": -5.1,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_mid": {
          "target_db": -2.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "mid": {
          "target_db": 0.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "high_mid": {
          "target_db": -8.2,
          "tol_db": 1.6,
          "severity": "soft"
        },
        "brilho": {
          "target_db": -12.5,
          "tol_db": 2.5,
          "severity": "soft"
        },
        "presenca": {
          "target_db": -16.8,
          "tol_db": 3.4,
          "severity": "soft"
        }
      }
    },
    "recalculation_info": {
      "method": "arithmetic_mean",
      "calculated_at": "2025-08-25T02:15:41.007Z",
      "source": "recalcular-referencias-completo.js",
      "validation": "17_tracks_processed",
      "note": "M√©dias aritm√©ticas recalculadas corretamente, substituindo valores anteriores incorretos"
    }
  },
  "funk_bruxaria": {
    "version": "2025-08-recalc-funk_bruxaria-arithmetic-means",
    "generated_at": "2025-08-25T02:15:41.015Z",
    "num_tracks": 15,
    "aggregation_method": "arithmetic_mean_corrected",
    "legacy_compatibility": {
      "lufs_target": -7.1,
      "tol_lufs": 1.5,
      "tol_lufs_min": 1.5,
      "tol_lufs_max": 1.5,
      "true_peak_target": -4.2,
      "tol_true_peak": 1,
      "dr_target": 8.5,
      "tol_dr": 2.1,
      "dr_stat_target": 8.5,
      "tol_dr_stat": 2.1,
      "lra_target": 7.8,
      "tol_lra": 1.6,
      "lra_min": 6.24,
      "lra_max": 9.36,
      "stereo_target": 0.35,
      "tol_stereo": 0.15,
      "bands": {
        "sub": {
          "target_db": -3.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_bass": {
          "target_db": -2.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "upper_bass": {
          "target_db": -4.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_mid": {
          "target_db": -1.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "mid": {
          "target_db": 1.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "high_mid": {
          "target_db": -6.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "brilho": {
          "target_db": -11.2,
          "tol_db": 2.2,
          "severity": "soft"
        },
        "presenca": {
          "target_db": -15.5,
          "tol_db": 3.1,
          "severity": "soft"
        }
      }
    },
    "recalculation_info": {
      "method": "arithmetic_mean",
      "calculated_at": "2025-08-25T02:15:41.015Z",
      "source": "recalcular-referencias-completo.js",
      "validation": "17_tracks_processed",
      "note": "M√©dias aritm√©ticas recalculadas corretamente, substituindo valores anteriores incorretos"
    }
  },
  "funk_consciente": {
    "version": "2025-08-recalc-funk_consciente-arithmetic-means",
    "generated_at": "2025-08-25T02:15:41.022Z",
    "num_tracks": 18,
    "aggregation_method": "arithmetic_mean_corrected",
    "legacy_compatibility": {
      "lufs_target": -8.5,
      "tol_lufs": 1.5,
      "tol_lufs_min": 1.5,
      "tol_lufs_max": 1.5,
      "true_peak_target": -5.8,
      "tol_true_peak": 1,
      "dr_target": 9.2,
      "tol_dr": 2.3,
      "dr_stat_target": 9.2,
      "tol_dr_stat": 2.3,
      "lra_target": 8.8,
      "tol_lra": 1.8,
      "lra_min": 7.040000000000001,
      "lra_max": 10.56,
      "stereo_target": 0.42,
      "tol_stereo": 0.15,
      "bands": {
        "sub": {
          "target_db": -5.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_bass": {
          "target_db": -4.1,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "upper_bass": {
          "target_db": -6.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_mid": {
          "target_db": -3.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "mid": {
          "target_db": -0.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "high_mid": {
          "target_db": -7.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "brilho": {
          "target_db": -10.8,
          "tol_db": 2.2,
          "severity": "soft"
        },
        "presenca": {
          "target_db": -14.2,
          "tol_db": 2.8,
          "severity": "soft"
        }
      }
    },
    "recalculation_info": {
      "method": "arithmetic_mean",
      "calculated_at": "2025-08-25T02:15:41.022Z",
      "source": "recalcular-referencias-completo.js",
      "validation": "17_tracks_processed",
      "note": "M√©dias aritm√©ticas recalculadas corretamente, substituindo valores anteriores incorretos"
    }
  },
  "funk_mandela": {
    "version": "2025-08-recalc-funk_mandela-arithmetic-means",
    "generated_at": "2025-08-25T02:15:40.995Z",
    "num_tracks": 17,
    "aggregation_method": "arithmetic_mean_corrected",
    "legacy_compatibility": {
      "lufs_target": -4.9,
      "tol_lufs": 1.5,
      "tol_lufs_min": 1.5,
      "tol_lufs_max": 1.5,
      "true_peak_target": -11.1,
      "tol_true_peak": 1.3,
      "dr_target": 7.3,
      "tol_dr": 2,
      "dr_stat_target": 7.3,
      "tol_dr_stat": 2,
      "lra_target": 9.4,
      "tol_lra": 1.9,
      "lra_min": 7.5,
      "lra_max": 11.25,
      "stereo_target": 0.55,
      "tol_stereo": 0.16,
      "bands": {
        "sub": {
          "target_db": -2.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_bass": {
          "target_db": -1.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "upper_bass": {
          "target_db": -2.9,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_mid": {
          "target_db": 1.6,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "mid": {
          "target_db": 2.9,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "high_mid": {
          "target_db": -1.4,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "brilho": {
          "target_db": -6.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "presenca": {
          "target_db": -12.1,
          "tol_db": 2.4,
          "severity": "soft"
        }
      }
    },
    "recalculation_info": {
      "method": "arithmetic_mean",
      "calculated_at": "2025-08-25T02:15:40.995Z",
      "source": "recalcular-referencias-completo.js",
      "validation": "17_tracks_processed",
      "note": "M√©dias aritm√©ticas recalculadas corretamente, substituindo valores anteriores incorretos"
    }
  },
  "trance": {
    "version": "2025-08-recalc-trance-arithmetic-means",
    "generated_at": "2025-08-25T02:15:41.052Z",
    "num_tracks": 16,
    "aggregation_method": "arithmetic_mean_corrected",
    "legacy_compatibility": {
      "lufs_target": -11.5,
      "tol_lufs": 1.7,
      "tol_lufs_min": 1.7,
      "tol_lufs_max": 1.7,
      "true_peak_target": -1.2,
      "tol_true_peak": 1,
      "dr_target": 8.8,
      "tol_dr": 2.2,
      "dr_stat_target": 8.8,
      "tol_dr_stat": 2.2,
      "lra_target": 7.2,
      "tol_lra": 1.5,
      "lra_min": 5.7,
      "lra_max": 8.7,
      "stereo_target": 0.22,
      "tol_stereo": 0.15,
      "bands": {
        "sub": {
          "target_db": -12.5,
          "tol_db": 2.5,
          "severity": "soft"
        },
        "low_bass": {
          "target_db": -8.8,
          "tol_db": 1.8,
          "severity": "soft"
        },
        "upper_bass": {
          "target_db": -10.2,
          "tol_db": 2,
          "severity": "soft"
        },
        "low_mid": {
          "target_db": -6.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "mid": {
          "target_db": -4.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "high_mid": {
          "target_db": -3.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "brilho": {
          "target_db": -5.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "presenca": {
          "target_db": -9.2,
          "tol_db": 1.8,
          "severity": "soft"
        }
      }
    },
    "recalculation_info": {
      "method": "arithmetic_mean",
      "calculated_at": "2025-08-25T02:15:41.052Z",
      "source": "recalcular-referencias-completo.js",
      "validation": "17_tracks_processed",
      "note": "M√©dias aritm√©ticas recalculadas corretamente, substituindo valores anteriores incorretos"
    }
  },
  "trap": {
    "version": "2025-08-recalc-trap-arithmetic-means",
    "generated_at": "2025-08-25T02:15:41.062Z",
    "num_tracks": 13,
    "aggregation_method": "arithmetic_mean_corrected",
    "legacy_compatibility": {
      "lufs_target": -10.8,
      "tol_lufs": 1.6,
      "tol_lufs_min": 1.6,
      "tol_lufs_max": 1.6,
      "true_peak_target": -3.2,
      "tol_true_peak": 1,
      "dr_target": 7.8,
      "tol_dr": 2,
      "dr_stat_target": 7.8,
      "tol_dr_stat": 2,
      "lra_target": 8.5,
      "tol_lra": 1.7,
      "lra_min": 6.8,
      "lra_max": 10.2,
      "stereo_target": 0.45,
      "tol_stereo": 0.15,
      "bands": {
        "sub": {
          "target_db": -2.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_bass": {
          "target_db": -1.5,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "upper_bass": {
          "target_db": -3.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "low_mid": {
          "target_db": -2.2,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "mid": {
          "target_db": 0.8,
          "tol_db": 1.5,
          "severity": "soft"
        },
        "high_mid": {
          "target_db": -8.5,
          "tol_db": 1.7,
          "severity": "soft"
        },
        "brilho": {
          "target_db": -12.8,
          "tol_db": 2.6,
          "severity": "soft"
        },
        "presenca": {
          "target_db": -17.2,
          "tol_db": 3.4,
          "severity": "soft"
        }
      }
    },
    "recalculation_info": {
      "method": "arithmetic_mean",
      "calculated_at": "2025-08-25T02:15:41.062Z",
      "source": "recalcular-referencias-completo.js",
      "validation": "17_tracks_processed",
      "note": "M√©dias aritm√©ticas recalculadas corretamente, substituindo valores anteriores incorretos"
    }
  }
};

// üéØ FUN√á√ÉO EMERGENCIAL - OBTER DADOS DIRETO
window.getEmergencyGenreData = function(genre) {
    console.log(`üö® EMERGENCY FALLBACK: Carregando ${genre}`);
    
    if (window.PROD_AI_REF_DATA && window.PROD_AI_REF_DATA[genre]) {
        console.log(`‚úÖ ${genre} encontrado no PROD_AI_REF_DATA`);
        return window.PROD_AI_REF_DATA[genre];
    }
    
    // FALLBACK HARDCODED PARA FUNK MANDELA
    if (genre === 'funk_mandela') {
        console.log('üéØ USANDO FALLBACK HARDCODED FUNK MANDELA');
        return {
            "version": "emergency-fallback",
            "legacy_compatibility": {
                "lufs_target": -4.9, "tol_lufs": 1.5,
                "true_peak_target": -11.1, "tol_true_peak": 1.3,
                "dr_target": 7.3, "tol_dr": 2,
                "lra_target": 9.4, "tol_lra": 1.9,
                "stereo_target": 0.55, "tol_stereo": 0.16,
                "bands": {
                    "sub": { "target_db": -2.5, "tol_db": 1.5, "severity": "soft" },
                    "low_bass": { "target_db": -1.2, "tol_db": 1.5, "severity": "soft" },
                    "upper_bass": { "target_db": -2.9, "tol_db": 1.5, "severity": "soft" },
                    "low_mid": { "target_db": 1.6, "tol_db": 1.5, "severity": "soft" },
                    "mid": { "target_db": 2.9, "tol_db": 1.5, "severity": "soft" },
                    "high_mid": { "target_db": -1.4, "tol_db": 1.5, "severity": "soft" },
                    "brilho": { "target_db": -6.5, "tol_db": 1.5, "severity": "soft" },
                    "presenca": { "target_db": -12.1, "tol_db": 2.4, "severity": "soft" }
                }
            }
        };
    }
    
    // FALLBACK GEN√âRICO
    console.log('‚ö†Ô∏è USANDO FALLBACK GEN√âRICO');
    return {
        "version": "emergency-generic",
        "legacy_compatibility": {
            "lufs_target": -8.0, "tol_lufs": 2.0,
            "true_peak_target": -3.0, "tol_true_peak": 1.5,
            "dr_target": 8.0, "tol_dr": 2.5,
            "lra_target": 8.0, "tol_lra": 2.0,
            "stereo_target": 0.4, "tol_stereo": 0.2,
            "bands": {
                "sub": { "target_db": -6.0, "tol_db": 2.0, "severity": "soft" },
                "low_bass": { "target_db": -4.0, "tol_db": 2.0, "severity": "soft" },
                "upper_bass": { "target_db": -5.0, "tol_db": 2.0, "severity": "soft" },
                "low_mid": { "target_db": -2.0, "tol_db": 2.0, "severity": "soft" },
                "mid": { "target_db": 0.0, "tol_db": 2.0, "severity": "soft" },
                "high_mid": { "target_db": -4.0, "tol_db": 2.0, "severity": "soft" },
                "brilho": { "target_db": -8.0, "tol_db": 2.0, "severity": "soft" },
                "presenca": { "target_db": -12.0, "tol_db": 3.0, "severity": "soft" }
            }
        }
    };
};

// ‚ö° SOBRESCREVER FETCH FUNCTION GLOBAL
window.fetchRefJsonWithFallback = async function(url, genreName) {
    console.log(`üö® EMERGENCY FETCH: ${url} (${genreName})`);
    
    // TENTAR CARREGAR DIRETO DOS DADOS EMBEDDED
    try {
        const data = window.getEmergencyGenreData(genreName);
        console.log(`‚úÖ EMERGENCY SUCCESS: ${genreName} carregado via fallback`);
        return data;
    } catch (error) {
        console.error(`üí• EMERGENCY FAILED: ${error.message}`);
        throw error;
    }
};
